<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Critical Minerals Intelligence Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
    <style>
        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --accent: #f093fb;
            --success: #43e97b;
            --warning: #fee140;
            --danger: #fa709a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: #333;
            overflow-x: hidden;
        }

        .header {
            background: rgba(255, 255, 255, 0.98);
            padding: 25px 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            color: var(--primary);
            font-size: 2.2em;
            margin-bottom: 5px;
        }

        .header-info p {
            color: #666;
            font-size: 0.95em;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
        }

        .nav-tab {
            padding: 10px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .nav-tab:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }

        .nav-tab.active {
            background: var(--secondary);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .container {
            max-width: 1400px;
            margin: 20px auto;
            padding: 0 20px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .card h2 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.4em;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        #map {
            height: 500px;
            border-radius: 8px;
            margin-top: 10px;
        }

        .periodic-table {
            display: grid;
            grid-template-columns: repeat(18, 1fr);
            gap: 2px;
            margin: 20px 0;
        }

        .element-box {
            aspect-ratio: 1;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 4px;
            font-size: 0.7em;
            text-align: center;
            background: #f5f5f5;
            cursor: pointer;
            transition: all 0.2s;
        }

        .element-box:hover {
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .element-box.rare-earth {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border-color: var(--primary);
            font-weight: bold;
        }

        .element-box .symbol {
            font-size: 1.4em;
            font-weight: bold;
        }

        .element-box .number {
            font-size: 0.7em;
            opacity: 0.7;
        }

        .workflow-diagram {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: linear-gradient(to right, #f8f9fa, #e9ecef);
            border-radius: 8px;
            margin: 15px 0;
        }

        .workflow-step {
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            flex: 1;
            margin: 0 10px;
        }

        .workflow-arrow {
            font-size: 2em;
            color: var(--primary);
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .metric-card {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .metric-value {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }

        .metric-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .risk-indicator {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .risk-high { background: #ffebee; color: #c62828; }
        .risk-medium { background: #fff3e0; color: #ef6c00; }
        .risk-low { background: #e8f5e9; color: #2e7d32; }

        .chart-container {
            position: relative;
            height: 350px;
            margin-top: 15px;
        }

        .supply-chain-viz {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 8px;
            margin: 15px 0;
        }

        .chain-node {
            text-align: center;
            position: relative;
        }

        .chain-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .data-table th {
            background: var(--primary);
            color: white;
            padding: 12px;
            text-align: left;
        }

        .data-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #ddd;
        }

        .data-table tr:hover {
            background: #f5f5f5;
        }

        .legend {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        @media (max-width: 1024px) {
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            .periodic-table {
                grid-template-columns: repeat(9, 1fr);
            }
            .workflow-diagram {
                flex-direction: column;
            }
            .workflow-arrow {
                transform: rotate(90deg);
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="header-info">
                <h1>üåç Critical Minerals Intelligence Platform</h1>
                <p>Comprehensive tracking of rare earth elements for policy, industry & investment decisions</p>
            </div>
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showTab('overview')">Overview</button>
                <button class="nav-tab" onclick="showTab('periodic')">Periodic Table</button>
                <button class="nav-tab" onclick="showTab('supply-chain')">Supply Chain</button>
                <button class="nav-tab" onclick="showTab('trends')">Historical Trends</button>
                <button class="nav-tab" onclick="showTab('stakeholders')">Stakeholder View</button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- OVERVIEW TAB -->
        <div id="overview" class="tab-content active">
            <div class="metric-grid">
                <div class="metric-card">
                    <div class="metric-label">Total REE Production</div>
                    <div class="metric-value">280K</div>
                    <div class="metric-label">tons/year (2024)</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">China Market Share</div>
                    <div class="metric-value">60%</div>
                    <div class="metric-label">Global dominance</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Critical Elements</div>
                    <div class="metric-value">5</div>
                    <div class="metric-label">Highest risk</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Avg Price Growth</div>
                    <div class="metric-value">+18%</div>
                    <div class="metric-label">YoY (2023-24)</div>
                </div>
            </div>

            <div class="grid-2">
                <div class="card full-width">
                    <h2>üìç Global Mining Operations</h2>
                    <div id="map"></div>
                </div>

                <div class="card">
                    <h2>üìä Production Share by Country</h2>
                    <div class="chart-container">
                        <canvas id="productionChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <h2>üéØ End-Use Applications</h2>
                    <div class="chart-container">
                        <canvas id="applicationsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- PERIODIC TABLE TAB -->
        <div id="periodic" class="tab-content">
            <div class="card">
                <h2>‚öõÔ∏è Periodic Table - Rare Earth Elements Highlighted</h2>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: linear-gradient(135deg, var(--primary), var(--accent));"></div>
                        <span>Rare Earth Element</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #f5f5f5;"></div>
                        <span>Other Elements</span>
                    </div>
                </div>
                <div id="periodicTable"></div>
            </div>

            <div class="card">
                <h2>üî¨ Lanthanide & Actinide Series</h2>
                <div style="margin: 20px 0;">
                    <h3 style="color: var(--secondary); margin-bottom: 10px;">Lanthanides (Rare Earths)</h3>
                    <div id="lanthanides" style="display: flex; gap: 5px; flex-wrap: wrap;"></div>
                </div>
            </div>

            <div class="card">
                <h2>üìã Critical Element Details</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Element</th>
                            <th>Symbol</th>
                            <th>Atomic #</th>
                            <th>Criticality</th>
                            <th>Primary Use</th>
                            <th>Supply Risk</th>
                        </tr>
                    </thead>
                    <tbody id="elementTable"></tbody>
                </table>
            </div>
        </div>

        <!-- SUPPLY CHAIN TAB -->
        <div id="supply-chain" class="tab-content">
            <div class="card">
                <h2>üîÑ Rare Earth Supply Chain Workflow</h2>
                <div class="workflow-diagram">
                    <div class="workflow-step">
                        <div style="font-size: 2em; margin-bottom: 10px;">‚õèÔ∏è</div>
                        <h3>Mining</h3>
                        <p>Ore extraction<br>3-5% REE content</p>
                    </div>
                    <div class="workflow-arrow">‚Üí</div>
                    <div class="workflow-step">
                        <div style="font-size: 2em; margin-bottom: 10px;">‚öóÔ∏è</div>
                        <h3>Separation</h3>
                        <p>Chemical processing<br>Individual elements</p>
                    </div>
                    <div class="workflow-arrow">‚Üí</div>
                    <div class="workflow-step">
                        <div style="font-size: 2em; margin-bottom: 10px;">üè≠</div>
                        <h3>Refining</h3>
                        <p>Purification<br>99.9% purity</p>
                    </div>
                    <div class="workflow-arrow">‚Üí</div>
                    <div class="workflow-step">
                        <div style="font-size: 2em; margin-bottom: 10px;">üîß</div>
                        <h3>Manufacturing</h3>
                        <p>Magnets, alloys<br>Components</p>
                    </div>
                    <div class="workflow-arrow">‚Üí</div>
                    <div class="workflow-step">
                        <div style="font-size: 2em; margin-bottom: 10px;">üöó</div>
                        <h3>End Products</h3>
                        <p>EVs, turbines<br>Electronics</p>
                    </div>
                </div>
            </div>

            <div class="grid-2">
                <div class="card">
                    <h2>üåê Supply Chain Concentration</h2>
                    <div class="supply-chain-viz">
                        <div class="chain-node">
                            <div class="chain-circle">60%</div>
                            <strong>China Mining</strong>
                        </div>
                        <div class="chain-node">
                            <div class="chain-circle">85%</div>
                            <strong>China Processing</strong>
                        </div>
                        <div class="chain-node">
                            <div class="chain-circle">90%</div>
                            <strong>China Refining</strong>
                        </div>
                    </div>
                    <div class="risk-indicator risk-high">‚ö†Ô∏è Critical Dependency</div>
                </div>

                <div class="card">
                    <h2>‚è±Ô∏è Lead Time Analysis</h2>
                    <div class="chart-container">
                        <canvas id="leadTimeChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <h2>üîÑ Recycling Potential</h2>
                    <div class="chart-container">
                        <canvas id="recyclingChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <h2>üåç Import Dependency (2024)</h2>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Country/Region</th>
                                <th>Import %</th>
                                <th>Primary Source</th>
                                <th>Risk Level</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>üá∫üá∏ United States</td>
                                <td>80%</td>
                                <td>China</td>
                                <td><span class="risk-indicator risk-high">High</span></td>
                            </tr>
                            <tr>
                                <td>üá™üá∫ European Union</td>
                                <td>98%</td>
                                <td>China</td>
                                <td><span class="risk-indicator risk-high">Critical</span></td>
                            </tr>
                            <tr>
                                <td>üáØüáµ Japan</td>
                                <td>100%</td>
                                <td>China</td>
                                <td><span class="risk-indicator risk-high">Critical</span></td>
                            </tr>
                            <tr>
                                <td>üá¶üá∫ Australia</td>
                                <td>15%</td>
                                <td>Domestic</td>
                                <td><span class="risk-indicator risk-low">Low</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- HISTORICAL TRENDS TAB -->
        <div id="trends" class="tab-content">
            <div class="grid-2">
                <div class="card">
                    <h2>üìà Price Trends (2015-2025)</h2>
                    <div class="chart-container">
                        <canvas id="priceHistoryChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <h2>üìä Production Volume Trends</h2>
                    <div class="chart-container">
                        <canvas id="productionTrendChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <h2>üîÆ Demand Forecast by Sector</h2>
                    <div class="chart-container">
                        <canvas id="demandForecastChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <h2>üí∞ Price Volatility Index</h2>
                    <div class="chart-container">
                        <canvas id="volatilityChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>üìä Key Market Events Timeline</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Year</th>
                            <th>Event</th>
                            <th>Impact</th>
                            <th>Price Change</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2010</td>
                            <td>China export quotas</td>
                            <td>Supply shock</td>
                            <td style="color: #c62828;">+750%</td>
                        </tr>
                        <tr>
                            <td>2015</td>
                            <td>Quota removal</td>
                            <td>Price correction</td>
                            <td style="color: #2e7d32;">-60%</td>
                        </tr>
                        <tr>
                            <td>2019</td>
                            <td>US-China trade tensions</td>
                            <td>Uncertainty spike</td>
                            <td style="color: #c62828;">+25%</td>
                        </tr>
                        <tr>
                            <td>2021</td>
                            <td>EV demand surge</td>
                            <td>Structural shift</td>
                            <td style="color: #c62828;">+140%</td>
                        </tr>
                        <tr>
                            <td>2024</td>
                            <td>US IRA investments</td>
                            <td>Diversification push</td>
                            <td style="color: #ef6c00;">+18%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- STAKEHOLDER VIEW TAB -->
        <div id="stakeholders" class="tab-content">
            <div class="grid-3">
                <div class="card">
                    <h2>üèõÔ∏è Government/Policy</h2>
                    <h3 style="color: var(--secondary); margin: 15px 0;">Strategic Priorities</h3>
                    <ul style="line-height: 2;">
                        <li>Supply chain resilience</li>
                        <li>National security concerns</li>
                        <li>Strategic reserve planning</li>
                        <li>Trade policy impacts</li>
                    </ul>
                    <h3 style="color: var(--secondary); margin: 15px 0;">Key Metrics</h3>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0;">
                        <strong>Import Dependency:</strong> 80%<br>
                        <strong>Domestic Capacity:</strong> 20K tons/yr<br>
                        <strong>Reserve Status:</strong> 1.2M tons<br>
                        <strong>Geopolitical Risk:</strong> <span class="risk-indicator risk-high">High</span>
                    </div>
                </div>

                <div class="card">
                    <h2>üè≠ OEMs & Manufacturers</h2>
                    <h3 style="color: var(--secondary); margin: 15px 0;">Critical Needs</h3>
                    <ul style="line-height: 2;">
                        <li>Price stability forecasts</li>
                        <li>Supplier reliability scores</li>
                        <li>Substitute materials R&D</li>
                        <li>Inventory optimization</li>
                    </ul>
                    <h3 style="color: var(--secondary); margin: 15px 0;">Cost Analysis</h3>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0;">
                        <strong>Avg. Lead Time:</strong> 6-12 months<br>
                        <strong>Price Volatility:</strong> ¬±35%/year<br>
                        <strong>REE Cost/Vehicle:</strong> $800-1200<br>
                        <strong>Alternative Options:</strong> <span class="risk-indicator risk-medium">Limited</span>
                    </div>
                </div>

                <div class="card">
                    <h2>üìä Investors & Analysts</h2>
                    <h3 style="color: var(--secondary); margin: 15px 0;">Investment Signals</h3>
                    <ul style="line-height: 2;">
                        <li>Market concentration risk</li>
                        <li>Emerging project pipeline</li>
                        <li>Technology disruption potential</li>
                        <li>ESG compliance metrics</li>
                    </ul>
                    <h3 style="color: var(--secondary); margin: 15px 0;">Market Outlook</h3>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0;">
                        <strong>Market Size (2024):</strong> $8.5B<br>
                        <strong>CAGR (2024-30):</strong> 12.4%<br>
                        <strong>Projects Pipeline:</strong> 25+ globally<br>
                        <strong>Investment Grade:</strong> <span class="risk-indicator risk-medium">Moderate Risk</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>üéØ Technology Roadmap: REE Usage by Sector</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Technology</th>
                            <th>Key REEs Used</th>
                            <th>Quantity/Unit</th>
                            <th>Growth Rate</th>
                            <th>Substitution Potential</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>üöó Electric Vehicles</td>
                            <td>Nd, Pr, Dy, Tb</td>
                            <td>0.5-1.5 kg</td>
                            <td style="color: #2e7d32;">+25%/year</td>
                            <td><span class="risk-indicator risk-high">Low</span></td>
                        </tr>
                        <tr>
                            <td>üå¨Ô∏è Wind Turbines</td>
                            <td>Nd, Pr, Dy</td>
                            <td>200-600 kg/MW</td>
                            <td style="color: #2e7d32;">+18%/year</td>
                            <td><span class="risk-indicator risk-medium">Medium</span></td>
                        </tr>
                        <tr>
                            <td>üì± Consumer Electronics</td>
                            <td>Nd, La, Y, Eu</td>
                            <td>5-20 g</td>
                            <td style="color: #ef6c00;">+8%/year</td>
                            <td><span class="risk-indicator risk-medium">Medium</span></td>
                        </tr>
                        <tr>
                            <td>üõ°Ô∏è Defense Systems</td>
                            <td>Nd, Sm, Tb, Dy</td>
                            <td>Classified</td>
                            <td style="color: #2e7d32;">+12%/year</td>
                            <td><span class="risk-indicator risk-high">Very Low</span></td>
                        </tr>
                        <tr>
                            <td>üí° LED Lighting</td>
                            <td>Y, Eu, Tb</td>
                            <td>0.1-0.5 g</td>
                            <td style="color: #666;">Stable</td>
                            <td><span class="risk-indicator risk-low">High</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="card">
                <h2>üå± Environmental & Sustainability Metrics</h2>
                <div class="grid-2">
                    <div>
                        <h3 style="color: var(--secondary); margin: 15px 0;">Mining Impact</h3>
                        <ul style="line-height: 2;">
                            <li>CO‚ÇÇ emissions: 8-12 tons per ton REE</li>
                            <li>Water usage: 10,000+ liters/ton</li>
                            <li>Land disturbance: 0.5-2 hectares/year</li>
                            <li>Radioactive waste concern</li>
                        </ul>
                    </div>
                    <div>
                        <h3 style="color: var(--secondary); margin: 15px 0;">Circular Economy</h3>
                        <ul style="line-height: 2;">
                            <li>Current recycling rate: &lt;1%</li>
                            <li>Target by 2030: 15-20%</li>
                            <li>Urban mining potential: High</li>
                            <li>E-waste recovery programs emerging</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============ DATA DEFINITIONS ============
        const rareEarthElements = [
            { name: 'Lanthanum', symbol: 'La', number: 57, criticality: 'Moderate', use: 'Batteries, optics', risk: 'Medium' },
            { name: 'Cerium', symbol: 'Ce', number: 58, criticality: 'Moderate', use: 'Catalytic converters', risk: 'Low' },
            { name: 'Praseodymium', symbol: 'Pr', number: 59, criticality: 'Critical', use: 'Magnets', risk: 'High' },
            { name: 'Neodymium', symbol: 'Nd', number: 60, criticality: 'Critical', use: 'EV motors, wind turbines', risk: 'High' },
            { name: 'Promethium', symbol: 'Pm', number: 61, criticality: 'Low', use: 'Research', risk: 'Low' },
            { name: 'Samarium', symbol: 'Sm', number: 62, criticality: 'Moderate', use: 'Magnets, lasers', risk: 'Medium' },
            { name: 'Europium', symbol: 'Eu', number: 63, criticality: 'Critical', use: 'LED displays', risk: 'High' },
            { name: 'Gadolinium', symbol: 'Gd', number: 64, criticality: 'Moderate', use: 'MRI contrast', risk: 'Medium' },
            { name: 'Terbium', symbol: 'Tb', number: 65, criticality: 'Most Critical', use: 'Magnets, sonar', risk: 'Very High' },
            { name: 'Dysprosium', symbol: 'Dy', number: 66, criticality: 'Most Critical', use: 'High-temp magnets', risk: 'Very High' },
            { name: 'Holmium', symbol: 'Ho', number: 67, criticality: 'Low', use: 'Lasers', risk: 'Low' },
            { name: 'Erbium', symbol: 'Er', number: 68, criticality: 'Moderate', use: 'Fiber optics', risk: 'Medium' },
            { name: 'Thulium', symbol: 'Tm', number: 69, criticality: 'Low', use: 'Medical lasers', risk: 'Low' },
            { name: 'Ytterbium', symbol: 'Yb', number: 70, criticality: 'Low', use: 'Lasers', risk: 'Low' },
            { name: 'Lutetium', symbol: 'Lu', number: 71, criticality: 'Low', use: 'PET scans', risk: 'Low' },
            { name: 'Scandium', symbol: 'Sc', number: 21, criticality: 'Moderate', use: 'Aerospace alloys', risk: 'Medium' },
            { name: 'Yttrium', symbol: 'Y', number: 39, criticality: 'Critical', use: 'LEDs, superconductors', risk: 'High' }
        ];

        const periodicData = [
            {symbol: 'H', number: 1}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: 'He', number: 2},
            {symbol: 'Li', number: 3}, {symbol: 'Be', number: 4}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: 'B', number: 5}, {symbol: 'C', number: 6}, {symbol: 'N', number: 7}, {symbol: 'O', number: 8}, {symbol: 'F', number: 9}, {symbol: 'Ne', number: 10},
            {symbol: 'Na', number: 11}, {symbol: 'Mg', number: 12}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: '', number: 0}, {symbol: 'Al', number: 13}, {symbol: 'Si', number: 14}, {symbol: 'P', number: 15}, {symbol: 'S', number: 16}, {symbol: 'Cl', number: 17}, {symbol: 'Ar', number: 18},
            {symbol: 'K', number: 19}, {symbol: 'Ca', number: 20}, {symbol: 'Sc', number: 21, isRareEarth: true}, {symbol: 'Ti', number: 22}, {symbol: 'V', number: 23}, {symbol: 'Cr', number: 24}, {symbol: 'Mn', number: 25}, {symbol: 'Fe', number: 26}, {symbol: 'Co', number: 27}, {symbol: 'Ni', number: 28}, {symbol: 'Cu', number: 29}, {symbol: 'Zn', number: 30}, {symbol: 'Ga', number: 31}, {symbol: 'Ge', number: 32}, {symbol: 'As', number: 33}, {symbol: 'Se', number: 34}, {symbol: 'Br', number: 35}, {symbol: 'Kr', number: 36},
            {symbol: 'Rb', number: 37}, {symbol: 'Sr', number: 38}, {symbol: 'Y', number: 39, isRareEarth: true}, {symbol: 'Zr', number: 40}, {symbol: 'Nb', number: 41}, {symbol: 'Mo', number: 42}, {symbol: 'Tc', number: 43}, {symbol: 'Ru', number: 44}, {symbol: 'Rh', number: 45}, {symbol: 'Pd', number: 46}, {symbol: 'Ag', number: 47}, {symbol: 'Cd', number: 48}, {symbol: 'In', number: 49}, {symbol: 'Sn', number: 50}, {symbol: 'Sb', number: 51}, {symbol: 'Te', number: 52}, {symbol: 'I', number: 53}, {symbol: 'Xe', number: 54},
            {symbol: 'Cs', number: 55}, {symbol: 'Ba', number: 56}, {symbol: 'La-Lu', number: 0, isLanthanide: true}, {symbol: 'Hf', number: 72}, {symbol: 'Ta', number: 73}, {symbol: 'W', number: 74}, {symbol: 'Re', number: 75}, {symbol: 'Os', number: 76}, {symbol: 'Ir', number: 77}, {symbol: 'Pt', number: 78}, {symbol: 'Au', number: 79}, {symbol: 'Hg', number: 80}, {symbol: 'Tl', number: 81}, {symbol: 'Pb', number: 82}, {symbol: 'Bi', number: 83}, {symbol: 'Po', number: 84}, {symbol: 'At', number: 85}, {symbol: 'Rn', number: 86}
        ];

        // ============ NAVIGATION ============
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // ============ MAP INITIALIZATION ============
        const map = L.map('map').setView([30, 10], 2);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap contributors'
        }).addTo(map);

        const productionSites = [
            { name: 'Bayan Obo, China', coords: [41.77, 109.97], production: '140,000 tons/year', share: '50%', type: 'Primary' },
            { name: 'Mount Weld, Australia', coords: [-28.57, 122.42], production: '20,000 tons/year', share: '7%', type: 'Primary' },
            { name: 'Mountain Pass, USA', coords: [35.48, -115.53], production: '38,000 tons/year', share: '14%', type: 'Primary' },
            { name: 'Myanmar Deposits', coords: [23.0, 97.0], production: '25,000 tons/year', share: '9%', type: 'Primary' },
            { name: 'Lovozero, Russia', coords: [67.9, 34.6], production: '2,500 tons/year', share: '1%', type: 'Secondary' }
        ];

        productionSites.forEach(site => {
            const marker = L.circleMarker(site.coords, {
                radius: site.type === 'Primary' ? 10 : 6,
                fillColor: site.type === 'Primary' ? '#667eea' : '#f093fb',
                color: '#fff',
                weight: 2,
                opacity: 1,
                fillOpacity: 0.8
            }).addTo(map);
            marker.bindPopup(`<strong>${site.name}</strong><br>Production: ${site.production}<br>Global Share: ${site.share}`);
        });

        // ============ CHARTS ============
        // Production Chart
        new Chart(document.getElementById('productionChart').getContext('2d'), {
            type: 'bar',
            data: {
                labels: ['China', 'USA', 'Myanmar', 'Australia', 'Thailand', 'India', 'Russia', 'Vietnam'],
                datasets: [{
                    label: 'Production (thousands of tons)',
                    data: [140, 38, 25, 20, 8, 3, 2.5, 4.5],
                    backgroundColor: ['#667eea', '#764ba2', '#f093fb', '#4facfe', '#43e97b', '#fa709a', '#fee140', '#30cfd0']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { y: { beginAtZero: true } }
            }
        });

        // Applications Chart
        new Chart(document.getElementById('applicationsChart').getContext('2d'), {
            type: 'doughnut',
            data: {
                labels: ['Magnets (35%)', 'Catalysts (22%)', 'Metallurgy (18%)', 'Glass (12%)', 'Electronics (8%)', 'Other (5%)'],
                datasets: [{
                    data: [35, 22, 18, 12, 8, 5],
                    backgroundColor: ['#667eea', '#764ba2', '#f093fb', '#4facfe', '#43e97b', '#fa709a']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });

        // Lead Time Chart
        new Chart(document.getElementById('leadTimeChart').getContext('2d'), {
            type: 'bar',
            data: {
                labels: ['Mining', 'Separation', 'Refining', 'Manufacturing', 'Total'],
                datasets: [{
                    label: 'Months',
                    data: [3, 2, 1.5, 2, 8.5],
                    backgroundColor: '#667eea'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y',
                plugins: { legend: { display: false } }
            }
        });

        // Recycling Chart
        new Chart(document.getElementById('recyclingChart').getContext('2d'), {
            type: 'doughnut',
            data: {
                labels: ['Virgin Material (99%)', 'Recycled (<1%)'],
                datasets: [{
                    data: [99, 1],
                    backgroundColor: ['#667eea', '#43e97b']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });

        // Price History Chart
        new Chart(document.getElementById('priceHistoryChart').getContext('2d'), {
            type: 'line',
            data: {
                labels: ['2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024', '2025'],
                datasets: [
                    {
                        label: 'Neodymium',
                        data: [45, 42, 55, 60, 48, 52, 75, 110, 95, 105, 115],
                        borderColor: '#667eea',
                        tension: 0.4
                    },
                    {
                        label: 'Dysprosium',
                        data: [280, 250, 220, 240, 260, 275, 320, 450, 400, 425, 460],
                        borderColor: '#764ba2',
                        tension: 0.4
                    },
                    {
                        label: 'Terbium',
                        data: [450, 420, 400, 435, 460, 480, 550, 680, 620, 650, 700],
                        borderColor: '#f093fb',
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { title: { display: false } },
                scales: {
                    y: {
                        title: { display: true, text: 'Price ($/kg)' }
                    }
                }
            }
        });

        // Production Trend Chart
        new Chart(document.getElementById('productionTrendChart').getContext('2d'), {
            type: 'line',
            data: {
                labels: ['2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024', '2025'],
                datasets: [
                    {
                        label: 'China',
                        data: [105, 110, 120, 125, 132, 140, 148, 155, 150, 145, 140],
                        borderColor: '#667eea',
                        tension: 0.4
                    },
                    {
                        label: 'Rest of World',
                        data: [25, 28, 32, 35, 40, 45, 55, 70, 85, 100, 115],
                        borderColor: '#43e97b',
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        title: { display: true, text: 'Production (thousands of tons)' }
                    }
                }
            }
        });

        // Demand Forecast Chart
        new Chart(document.getElementById('demandForecastChart').getContext('2d'), {
            type: 'bar',
            data: {
                labels: ['2024', '2025', '2026', '2027', '2028', '2029', '2030'],
                datasets: [
                    {
                        label: 'EVs',
                        data: [45, 55, 68, 85, 105, 130, 160],
                        backgroundColor: '#667eea'
                    },
                    {
                        label: 'Wind Energy',
                        data: [35, 40, 46, 53, 62, 72, 85],
                        backgroundColor: '#43e97b'
                    },
                    {
                        label: 'Electronics',
                        data: [30, 32, 34, 36, 38, 40, 42],
                        backgroundColor: '#f093fb'
                    },
                    {
                        label: 'Other',
                        data: [20, 22, 24, 26, 28, 30, 33],
                        backgroundColor: '#fee140'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { stacked: true },
                    y: {
                        stacked: true,
                        title: { display: true, text: 'Demand (thousands of tons)' }
                    }
                }
            }
        });

        // Volatility Chart
        new Chart(document.getElementById('volatilityChart').getContext('2d'), {
            type: 'bar',
            data: {
                labels: ['Nd', 'Dy', 'Tb', 'Pr', 'Eu', 'Y', 'La', 'Ce'],
                datasets: [{
                    label: 'Annual Volatility (%)',
                    data: [35, 42, 48, 38, 40, 28, 15, 12],
                    backgroundColor: ['#c62828', '#c62828', '#c62828', '#ef6c00', '#ef6c00', '#ef6c00', '#43e97b', '#43e97b']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } }
            }
        });

        // ============ PERIODIC TABLE ============
        const periodicTable = document.getElementById('periodicTable');
        periodicData.forEach(elem => {
            const box = document.createElement('div');
            if (elem.symbol) {
                box.className = `element-box ${elem.isRareEarth || elem.isLanthanide ? 'rare-earth' : ''}`;
                box.innerHTML = `
                    <div class="number">${elem.number || ''}</div>
                    <div class="symbol">${elem.symbol}</div>
                `;
                if (elem.isRareEarth) {
                    const reeData = rareEarthElements.find(e => e.symbol === elem.symbol);
                    if (reeData) {
                        box.title = `${reeData.name} - ${reeData.use}`;
                    }
                }
            } else {
                box.className = 'element-box';
                box.style.background = 'transparent';
                box.style.border = 'none';
            }
            periodicTable.appendChild(box);
        });

        // Lanthanides display
        const lanthanides = document.getElementById('lanthanides');
        rareEarthElements.filter(e => e.number >= 57 && e.number <= 71).forEach(elem => {
            const box = document.createElement('div');
            box.className = 'element-box rare-earth';
            box.style.width = '80px';
            box.innerHTML = `
                <div class="number">${elem.number}</div>
                <div class="symbol">${elem.symbol}</div>
                <div style="font-size: 0.6em; margin-top: 2px;">${elem.name}</div>
            `;
            box.title = elem.use;
            lanthanides.appendChild(box);
        });

        // Element table
        const elementTable = document.getElementById('elementTable');
        rareEarthElements.forEach(elem => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><strong>${elem.name}</strong></td>
                <td>${elem.symbol}</td>
                <td>${elem.number}</td>
                <td><span class="risk-indicator risk-${elem.risk.toLowerCase().replace(' ', '-')}">${elem.criticality}</span></td>
                <td>${elem.use}</td>
                <td><span class="risk-indicator risk-${elem.risk.toLowerCase().replace(' ', '-')}">${elem.risk}</span></td>
            `;
            elementTable.appendChild(row);
        });
    </script>
</body>
</html>
